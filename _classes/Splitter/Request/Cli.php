<?php

/**
 * @package	 Splitter
 * @subpackage  request
 * @version	 $Id$
 */
/**
 * –û–±—ä–µ–∫—Ç –∑–∞–ø—Ä–æ—Å–∞. –ü–æ–¥–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.
 * –§–æ—Ä–º–∞—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: -param1 value1 -param2 -param3 value3
 *
 * @access	  public
 * @package	 Splitter
 * @subpackage  request
 * @see		 Splitter_abstract_Request
 */
class Splitter_Request_Cli extends Splitter_Request_Abstract
{
	/**
	 * –?–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –º–∞—Å—Å–∏–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–∞.
	 *
	 * @access  protected
	 */
	function _initParams()
	{
		$argc = $_SERVER['argc'];
		$argv = $_SERVER['argv'];

		// –µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω—ã –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (–ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ –Ω–µ
		// —Å—á–∏—Ç–∞–µ—Ç—Å—è, —ç—Ç–æ –∏–º—è —Ñ–∞–π–ª–∞)
		if ($argc > 1)
		{
			for ($i = 1; $i < $argc; $i++)
			{
				// –µ—Å–ª–∏ —ç—Ç–æ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
				if ($this->_isParamName($argv[$i]))
				{
					// –∏ –ø–æ—Å–ª–µ –Ω–µ–≥–æ —Å–ª–µ–¥—É–µ—Ç –µ—â–µ –æ–¥–∏–Ω –∞—Ä–≥—É–º–µ–Ω—Ç
					if (($argc > $i + 1)

						// –∏ —ç—Ç–æ –Ω–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
						&& !$this->_isParamName($argv[$i + 1]))
					{
						// –¥–æ–±–∞–≤–ª—è–µ–º –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –∏ –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ
						// –≤ –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–π –º–∞—Å—Å–∏–≤
						$this->_params[substr($argv[$i], 1)] = $argv[++$i];
					}
					else
					{
						// –∏–Ω–∞—á–µ –¥–æ–±–∞–≤–ª—è–µ–º –≤ –º–∞—Å—Å–∏–≤ –ø—Ä–æ—Å—Ç–æ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
						$this->_params[$argv[$i]] = true;
					}
				}
			}
		}
	}

	/**
	 * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —É–∫–∞–∑–∞–Ω–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞.
	 *
	 * @access  private
	 * @param   string   $arg
	 * @return  boolean
	 */
	function _isParamName($arg)
	{
		return '-' == substr($arg, 0, 1);
	}
}
